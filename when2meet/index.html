<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>When2Meet - Find the perfect time for everyone</title>
    <meta name="description" content="When2Meet helps you find the perfect time for meetings with multiple participants. Create events, share availability, and schedule efficiently.">
    <meta name="keywords" content="meeting scheduler, when2meet, calendar, availability, scheduling, team meetings">
    <meta name="author" content="When2Meet Team">
    <meta property="og:title" content="When2Meet - Meeting Scheduler">
    <meta property="og:description" content="Find the perfect time for everyone to meet">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://example.com/when2meet/">
    <meta property="og:image" content="favicon.svg">
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="nav-brand">
                <h1 class="logo">When2Meet</h1>
                <span class="tagline">Find the perfect time for everyone</span>
            </div>
            <nav class="nav-menu">
                <a href="index.html" class="nav-link active">Home</a>
                <a href="dashboard.html" class="nav-link">My Events</a>
                <a href="create.html" class="nav-link create-btn">+ New Event</a>
                <div class="user-menu">
                    <div class="user-avatar">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMjAiIGZpbGw9IiM2MzY2RjEiLz4KPHN2ZyB4PSI4IiB5PSI4IiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSI+CjxwYXRoIGQ9Im0xMiAxMmMxLjY1NDQgMCAzLTEuMzQ1NiAzLTNzLTEuMzQ1Ni0zLTMtMy0zIDEuMzQ1Ni0zIDMgMS4zNDU2IDMgMyAzem0wIDFjLTIuMDA0NCAwLTYgMS4wMDc4LTYgM3YxaDE2di0xYzAtMS45OTIyLTMuOTk1Ni0zLTYtM3oiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo8L3N2Zz4K" alt="User Avatar">
                    </div>
                    <div class="user-info">
                        <span class="username">jun</span>
                        <div class="user-dropdown">
                            <a href="#" class="dropdown-item">Profile</a>
                            <a href="#" class="dropdown-item">Settings</a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-item">Sign Out</a>
                        </div>
                    </div>
                </div>
            </nav>
            <button class="mobile-menu-toggle" aria-label="Toggle mobile menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </header>

    <main class="main-content">
        <section class="hero-section">
            <div class="container">
                <div class="hero-content">
                    <h2 class="hero-title">Welcome back, jun!</h2>
                    <p class="hero-subtitle">Ready to schedule your next meeting? Create an event or join an existing one.</p>
                    <div class="hero-actions">
                        <a href="create.html" class="btn btn-primary btn-large">Create New Event</a>
                        <button class="btn btn-secondary btn-large" onclick="showJoinModal()">Join Event</button>
                    </div>
                </div>
            </div>
        </section>

        <section class="quick-stats">
            <div class="container">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üìÖ</div>
                        <div class="stat-number">12</div>
                        <div class="stat-label">Events Created</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-number">48</div>
                        <div class="stat-label">Total Participants</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚è∞</div>
                        <div class="stat-number">7</div>
                        <div class="stat-label">Active Events</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-number">5</div>
                        <div class="stat-label">Completed</div>
                    </div>
                </div>
            </div>
        </section>

        <section class="recent-events">
            <div class="container">
                <div class="section-header">
                    <h3>Recent Events</h3>
                    <a href="dashboard.html" class="view-all-link">View All ‚Üí</a>
                </div>
                <div class="events-grid" id="recentEventsGrid">
                    <!-- Events will be populated by JavaScript -->
                </div>
            </div>
        </section>

        <section class="search-section">
            <div class="container">
                <div class="search-header">
                    <h3>Find Events</h3>
                    <p>Search for public events or join with an event code</p>
                </div>
                <div class="search-container">
                    <input type="text" class="search-input" placeholder="Search events by title, creator, or tags..." id="eventSearchInput">
                    <button class="search-btn" onclick="searchEvents()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                    </button>
                </div>
                <div class="search-results" id="searchResults" style="display: none;">
                    <!-- Search results will be populated here -->
                </div>
            </div>
        </section>

        <section class="featured-events">
            <div class="container">
                <h3>Public Events</h3>
                <div class="events-grid" id="publicEventsGrid">
                    <!-- Public events will be populated by JavaScript -->
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>When2Meet</h4>
                    <p>The easiest way to schedule meetings with multiple people.</p>
                </div>
                <div class="footer-section">
                    <h5>Product</h5>
                    <a href="#" class="footer-link">Features</a>
                    <a href="#" class="footer-link">Pricing</a>
                    <a href="#" class="footer-link">API</a>
                </div>
                <div class="footer-section">
                    <h5>Support</h5>
                    <a href="#" class="footer-link">Help Center</a>
                    <a href="#" class="footer-link">Contact</a>
                    <a href="#" class="footer-link">Status</a>
                </div>
                <div class="footer-section">
                    <h5>Legal</h5>
                    <a href="#" class="footer-link">Privacy</a>
                    <a href="#" class="footer-link">Terms</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 When2Meet. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Join Event Modal -->
    <div class="modal" id="joinModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Join Event</h3>
                <button class="modal-close" onclick="hideJoinModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="eventCode">Event Code or URL</label>
                    <input type="text" id="eventCode" class="form-input" placeholder="Enter event code or paste URL">
                </div>
                <div class="form-group">
                    <label for="participantName">Your Name</label>
                    <input type="text" id="participantName" class="form-input" value="jun" readonly>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="hideJoinModal()">Cancel</button>
                <button class="btn btn-primary" onclick="joinEvent()">Join Event</button>
            </div>
        </div>
    </div>

    <!-- Loading overlay -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="loading-spinner"></div>
    </div>

    <script src="data.js"></script>
    <script src="utils.js"></script>
    <script src="script.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/when2meet/sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful:', registration);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New service worker available
                                    if (confirm('A new version of When2Meet is available. Reload to update?')) {
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch(error => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }
        
        // PWA Install Prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button or banner
            const installBanner = document.createElement('div');
            installBanner.innerHTML = `
                <div style="position: fixed; bottom: 20px; left: 20px; right: 20px; background: #667eea; color: white; padding: 15px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); display: flex; justify-content: space-between; align-items: center; z-index: 10000;">
                    <span>Install When2Meet for a better experience!</span>
                    <button id="installBtn" style="background: white; color: #667eea; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; font-weight: 600;">Install</button>
                    <button id="dismissBtn" style="background: transparent; color: white; border: 1px solid white; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-left: 10px;">Later</button>
                </div>
            `;
            document.body.appendChild(installBanner);
            
            document.getElementById('installBtn').addEventListener('click', () => {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                    } else {
                        console.log('User dismissed the install prompt');
                    }
                    deferredPrompt = null;
                    installBanner.remove();
                });
            });
            
            document.getElementById('dismissBtn').addEventListener('click', () => {
                installBanner.remove();
            });
        });
        
        // Hide install banner after installation
        window.addEventListener('appinstalled', () => {
            console.log('When2Meet was installed');
            const banner = document.querySelector('[style*="position: fixed"]');
            if (banner) banner.remove();
        });
    </script>
</body>
</html>
